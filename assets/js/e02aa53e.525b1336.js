"use strict";(self.webpackChunkdocs_website=self.webpackChunkdocs_website||[]).push([[41],{3905:(e,t,n)=>{n.d(t,{Zo:()=>d,kt:()=>h});var o=n(7294);function a(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function r(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,o)}return n}function s(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?r(Object(n),!0).forEach((function(t){a(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):r(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function i(e,t){if(null==e)return{};var n,o,a=function(e,t){if(null==e)return{};var n,o,a={},r=Object.keys(e);for(o=0;o<r.length;o++)n=r[o],t.indexOf(n)>=0||(a[n]=e[n]);return a}(e,t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);for(o=0;o<r.length;o++)n=r[o],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(a[n]=e[n])}return a}var c=o.createContext({}),l=function(e){var t=o.useContext(c),n=t;return e&&(n="function"==typeof e?e(t):s(s({},t),e)),n},d=function(e){var t=l(e.components);return o.createElement(c.Provider,{value:t},e.children)},p={inlineCode:"code",wrapper:function(e){var t=e.children;return o.createElement(o.Fragment,{},t)}},b=o.forwardRef((function(e,t){var n=e.components,a=e.mdxType,r=e.originalType,c=e.parentName,d=i(e,["components","mdxType","originalType","parentName"]),b=l(n),h=a,f=b["".concat(c,".").concat(h)]||b[h]||p[h]||r;return n?o.createElement(f,s(s({ref:t},d),{},{components:n})):o.createElement(f,s({ref:t},d))}));function h(e,t){var n=arguments,a=t&&t.mdxType;if("string"==typeof e||a){var r=n.length,s=new Array(r);s[0]=b;var i={};for(var c in t)hasOwnProperty.call(t,c)&&(i[c]=t[c]);i.originalType=e,i.mdxType="string"==typeof e?e:a,s[1]=i;for(var l=2;l<r;l++)s[l]=n[l];return o.createElement.apply(null,s)}return o.createElement.apply(null,n)}b.displayName="MDXCreateElement"},8709:(e,t,n)=>{n.r(t),n.d(t,{assets:()=>c,contentTitle:()=>s,default:()=>p,frontMatter:()=>r,metadata:()=>i,toc:()=>l});var o=n(7462),a=(n(7294),n(3905));const r={sidebar_label:"Multi-Node Mode",sidebar_position:6},s="Creating a Multi-Node local testnet",i={unversionedId:"node/multi-node",id:"node/multi-node",title:"Creating a Multi-Node local testnet",description:"For more advanced smart contracts debugging and testing closer to the real network environment, you can build your local testnet that consists of several interconnected nodes. This mode allows to see the multi-node consensus algorithm in action.",source:"@site/docs/node/multi-node.md",sourceDirName:"node",slug:"/node/multi-node",permalink:"/docs/node/multi-node",draft:!1,editUrl:"https://github.com/gear-tech/wiki/edit/master/docs/node/multi-node.md",tags:[],version:"current",sidebarPosition:6,frontMatter:{sidebar_label:"Multi-Node Mode",sidebar_position:6},sidebar:"tutorialSidebar",previous:{title:"Dev Net Mode",permalink:"/docs/node/dev-net"},next:{title:"Node FAQ",permalink:"/docs/node/node-faq"}},c={},l=[],d={toc:l};function p(e){let{components:t,...n}=e;return(0,a.kt)("wrapper",(0,o.Z)({},d,n,{components:t,mdxType:"MDXLayout"}),(0,a.kt)("h1",{id:"creating-a-multi-node-local-testnet"},"Creating a Multi-Node local testnet"),(0,a.kt)("p",null,"For more advanced smart contracts debugging and testing closer to the real network environment, you can build your local testnet that consists of several interconnected nodes. This mode allows to see the multi-node consensus algorithm in action."),(0,a.kt)("p",null,"Run a local testnet with two validator nodes, Alice and Bob, that have been ",(0,a.kt)("a",{parentName:"p",href:"https://github.com/gear-tech/gear/blob/master/node/src/chain_spec.rs"},"configured")," as the initial authorities of the ",(0,a.kt)("inlineCode",{parentName:"p"},"local")," testnet chain and endowed with testnet units."),(0,a.kt)("p",null,"Note: this will require two terminal sessions (one for each node)."),(0,a.kt)("ol",null,(0,a.kt)("li",{parentName:"ol"},(0,a.kt)("p",{parentName:"li"},"Start Alice's node first. The command below uses the default TCP port (30333) and specifies ",(0,a.kt)("inlineCode",{parentName:"p"},"/tmp/alice")," as the chain database location. Alice's node ID will be ",(0,a.kt)("inlineCode",{parentName:"p"},"12D3KooWEyoppNCUx8Yx66oV9fJnriXwCcXwDDUA2kj6vnc6iDEp")," (legacy representation: ",(0,a.kt)("inlineCode",{parentName:"p"},"QmRpheLN4JWdAnY7HGJfWFNbfkQCb6tFf4vvA6hgjMZKrR"),"); this is determined by the node-key."),(0,a.kt)("pre",{parentName:"li"},(0,a.kt)("code",{parentName:"pre",className:"language-bash"},"gear \\\n  --base-path /tmp/alice \\\n  --chain=local \\\n  --alice \\\n  --node-key 0000000000000000000000000000000000000000000000000000000000000001 \\\n  --telemetry-url 'ws://telemetry-backend-shard.gear-tech.io:32001/submit 0'\n")),(0,a.kt)("p",{parentName:"li"},"The Alice node will be run in idle mode at block #0 waiting for the second validator node."),(0,a.kt)("pre",{parentName:"li"},(0,a.kt)("code",{parentName:"pre"},'Gear Node\n\u270c\ufe0f version 0.1.0-6dc8d24edd9\n\u2764\ufe0f by Gear Technologies, 2021-2022\n\ud83d\udccb Chain specification: Gear Local Testnet\n\ud83c\udff7 Node name: Alice\n\ud83d\udc64 Role: AUTHORITY\n\ud83d\udcbe Database: RocksDb at /tmp/alice/chains/gear_local_testnet/db/full\n\u26d3 Native runtime: gear-610 (gear-1.tx1.au1)\n\ud83d\udc76 Creating empty BABE epoch changes on what appears to be first startup.\nUsing default protocol ID "sup" because none is configured in the chain specs\n\ud83c\udff7 Local node identity is: 12D3KooWEyoppNCUx8Yx66oV9fJnriXwCcXwDDUA2kj6vnc6iDEp\n\ud83d\udcbb Operating system: macos\n\ud83d\udcbb CPU architecture: aarch64\n\ud83d\udce6 Highest known block at #0\n\u303d\ufe0f Prometheus exporter started at 127.0.0.1:9615\nRunning JSON-RPC HTTP server: addr=127.0.0.1:9933, allowed origins=Some(["http://localhost:*", "http://127.0.0.1:*", "https://localhost:*", "https://127.0.0.1:*", "https://polkadot.js.org"])\nRunning JSON-RPC WS server: addr=127.0.0.1:9944, allowed origins=Some(["http://localhost:*", "http://127.0.0.1:*", "https://localhost:*", "https://127.0.0.1:*", "https://polkadot.js.org"])\n\ud83c\udfc1 CPU score: 1020MB/s\n\ud83c\udfc1 Memory score: 37732MB/s\n\ud83c\udfc1 Disk score (seq. writes): 1496MB/s\n\ud83c\udfc1 Disk score (rand. writes): 421MB/s\n\ud83d\udc76 Starting BABE Authorship worker\n\ud83d\udca4 Idle (0 peers), best: #0 (0x22c7\u20266847), finalized #0 (0x22c7\u20266847), \u2b07 0 \u2b06 0\n\ud83d\udca4 Idle (0 peers), best: #0 (0x22c7\u20266847), finalized #0 (0x22c7\u20266847), \u2b07 0 \u2b06 0\n\ud83d\udca4 Idle (0 peers), best: #0 (0x22c7\u20266847), finalized #0 (0x22c7\u20266847), \u2b07 0 \u2b06 0\n\ud83d\udca4 Idle (0 peers), best: #0 (0x22c7\u20266847), finalized #0 (0x22c7\u20266847), \u2b07 0 \u2b06 0\n')),(0,a.kt)("p",{parentName:"li"},"Also, you can find the ",(0,a.kt)("inlineCode",{parentName:"p"},"Alice")," node name on the telemetry site (",(0,a.kt)("a",{parentName:"p",href:"https://telemetry.gear-tech.io"},"https://telemetry.gear-tech.io"),") under the ",(0,a.kt)("strong",{parentName:"p"},"Gear Local Testnet")," tab.")),(0,a.kt)("li",{parentName:"ol"},(0,a.kt)("p",{parentName:"li"},"In another terminal, use the following command to start Bob's node on a different TCP port (",(0,a.kt)("inlineCode",{parentName:"p"},"30334"),") and with a chain database location of ",(0,a.kt)("inlineCode",{parentName:"p"},"/tmp/bob"),". The ",(0,a.kt)("inlineCode",{parentName:"p"},"--bootnodes")," option will connect this node to the Alice's one on TCP port ",(0,a.kt)("inlineCode",{parentName:"p"},"30333"),":"),(0,a.kt)("pre",{parentName:"li"},(0,a.kt)("code",{parentName:"pre",className:"language-bash"},"gear \\\n  --base-path /tmp/bob \\\n  --bootnodes /ip4/127.0.0.1/tcp/30333/p2p/12D3KooWEyoppNCUx8Yx66oV9fJnriXwCcXwDDUA2kj6vnc6iDEp \\\n  --chain=local \\\n  --bob \\\n  --port 30334 \\\n  --ws-port 9945 \\\n  --telemetry-url 'ws://telemetry-backend-shard.gear-tech.io:32001/submit 0'\n")),(0,a.kt)("p",{parentName:"li"},"After running the second validator the network starts to produce new blocks."),(0,a.kt)("pre",{parentName:"li"},(0,a.kt)("code",{parentName:"pre"},'Gear Node\n\u270c\ufe0f version 0.1.0-6dc8d24edd9\n\u2764\ufe0f by Gear Technologies, 2021-2022\n\ud83d\udccb Chain specification: Gear Local Testnet\n\ud83c\udff7 Node name: Bob\n\ud83d\udc64 Role: AUTHORITY\n\ud83d\udcbe Database: RocksDb at /tmp/bob/chains/gear_local_testnet/db/full\n\u26d3 Native runtime: gear-610 (gear-1.tx1.au1)\n\ud83d\udd28 Initializing Genesis block/state (state: 0xf470\u2026d2dc, header-hash: 0x22c7\u20266847)\n\ud83d\udc74 Loading GRANDPA authority set from genesis on what appears to be first startup.\n\ud83d\udc76 Creating empty BABE epoch changes on what appears to be first startup.\nUsing default protocol ID "sup" because none is configured in the chain specs\n\ud83c\udff7 Local node identity is: 12D3KooWHpsf9Gp59ct6t6d1MmKHxbmZRvSWcUej7cUNmWNBdvZE\n\ud83d\udcbb Operating system: macos\n\ud83d\udcbb CPU architecture: aarch64\n\ud83d\udce6 Highest known block at #0\nRunning JSON-RPC HTTP server: addr=127.0.0.1:61429, allowed origins=Some(["http://localhost:*", "http://127.0.0.1:*", "https://localhost:*", "https://127.0.0.1:*", "https://polkadot.js.org"])\nRunning JSON-RPC WS server: addr=127.0.0.1:9945, allowed origins=Some(["http://localhost:*", "http://127.0.0.1:*", "https://localhost:*", "https://127.0.0.1:*", "https://polkadot.js.org"])\n\ud83c\udfc1 CPU score: 875MB/s\n\ud83c\udfc1 Memory score: 38353MB/s\n\ud83c\udfc1 Disk score (seq. writes): 1497MB/s\n\ud83c\udfc1 Disk score (rand. writes): 421MB/s\n\ud83d\udc76 Starting BABE Authorship worker\ndiscovered: 12D3KooWEyoppNCUx8Yx66oV9fJnriXwCcXwDDUA2kj6vnc6iDEp /ip4/192.168.1.4/tcp/30333\ndiscovered: 12D3KooWEyoppNCUx8Yx66oV9fJnriXwCcXwDDUA2kj6vnc6iDEp /ip6/::1/tcp/30333\ndiscovered: 12D3KooWEyoppNCUx8Yx66oV9fJnriXwCcXwDDUA2kj6vnc6iDEp /ip4/127.0.0.1/tcp/30333\n\ud83d\ude4c Starting consensus session on top of parent 0x22c70bb6baf611e5c9a6b1886b307dfa25cf1972b3400e70eb15d624c8b96847\n\ud83c\udf81 Prepared block for proposing at 1 (0 ms) [hash: 0x1f55c4a9daf8c35d4388313ad67deec4ff5e472659e2fec310bd3032bcbdfe71; parent_hash: 0x22c7\u20266847; extrinsics (2): [0x8bbd\u20262a85, 0x7d5c\u20260b86]]\n\ud83d\udd16 Pre-sealed block for proposal at 1. Hash now 0xe46f6031bb73710e239665d0da4212fbdcca77d57f9504d357c078f3b315389e, previously 0x1f55c4a9daf8c35d4388313ad67deec4ff5e472659e2fec310bd3032bcbdfe71.\n\ud83d\udc76 New epoch 0 launching at block 0xe46f\u2026389e (block slot 1667197557 >= start slot 1667197557).\n\ud83d\udc76 Next epoch starts at slot 1667198157\n\u2728 Imported #1 (0xe46f\u2026389e)\n\ud83d\ude4c Starting consensus session on top of parent 0xe46f6031bb73710e239665d0da4212fbdcca77d57f9504d357c078f3b315389e\n\ud83c\udf81 Prepared block for proposing at 2 (0 ms) [hash: 0x66281c25f34157c713876cda6f39324a0da6a9a50c0c32310683bca875c1ab4c; parent_hash: 0xe46f\u2026389e; extrinsics (2): [0xcb81\u2026f7c3, 0x7d5c\u20260b86]]\n\ud83d\udd16 Pre-sealed block for proposal at 2. Hash now 0x2ab179fe98969cab0970df085b86e03dbee33daed527f6595bcdbeffebc64175, previously 0x66281c25f34157c713876cda6f39324a0da6a9a50c0c32310683bca875c1ab4c.\n\u2728 Imported #2 (0x2ab1\u20264175)\n\ud83d\ude4c Starting consensus session on top of parent 0x2ab179fe98969cab0970df085b86e03dbee33daed527f6595bcdbeffebc64175\n\ud83c\udf81 Prepared block for proposing at 3 (0 ms) [hash: 0xb5b9be01adb191671e0421f4673f8bee0751481aaac7ea453d806161e3b46dd7; parent_hash: 0x2ab1\u20264175; extrinsics (2): [0x7771\u2026de48, 0x7d5c\u20260b86]]\n\ud83d\udd16 Pre-sealed block for proposal at 3. Hash now 0xf2ed128d41d96da623281745555a0fe00a033630aacf57ac02acc31ced267db0, previously 0xb5b9be01adb191671e0421f4673f8bee0751481aaac7ea453d806161e3b46dd7.\n\u2728 Imported #3 (0xf2ed\u20267db0)\n'))),(0,a.kt)("li",{parentName:"ol"},(0,a.kt)("p",{parentName:"li"},"The network is live! If you want to stop it, just press ",(0,a.kt)("kbd",null,"Ctrl")," + ",(0,a.kt)("kbd",null,"C")," in both running sessions."))))}p.isMDXComponent=!0}}]);