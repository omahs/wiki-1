"use strict";(self.webpackChunkdocs_website=self.webpackChunkdocs_website||[]).push([[5816],{3905:(e,t,r)=>{r.d(t,{Zo:()=>c,kt:()=>u});var n=r(7294);function a(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function i(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function o(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?i(Object(r),!0).forEach((function(t){a(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):i(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function s(e,t){if(null==e)return{};var r,n,a=function(e,t){if(null==e)return{};var r,n,a={},i=Object.keys(e);for(n=0;n<i.length;n++)r=i[n],t.indexOf(r)>=0||(a[r]=e[r]);return a}(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(n=0;n<i.length;n++)r=i[n],t.indexOf(r)>=0||Object.prototype.propertyIsEnumerable.call(e,r)&&(a[r]=e[r])}return a}var l=n.createContext({}),p=function(e){var t=n.useContext(l),r=t;return e&&(r="function"==typeof e?e(t):o(o({},t),e)),r},c=function(e){var t=p(e.components);return n.createElement(l.Provider,{value:t},e.children)},d={inlineCode:"code",wrapper:function(e){var t=e.children;return n.createElement(n.Fragment,{},t)}},g=n.forwardRef((function(e,t){var r=e.components,a=e.mdxType,i=e.originalType,l=e.parentName,c=s(e,["components","mdxType","originalType","parentName"]),g=p(r),u=a,m=g["".concat(l,".").concat(u)]||g[u]||d[u]||i;return r?n.createElement(m,o(o({ref:t},c),{},{components:r})):n.createElement(m,o({ref:t},c))}));function u(e,t){var r=arguments,a=t&&t.mdxType;if("string"==typeof e||a){var i=r.length,o=new Array(i);o[0]=g;var s={};for(var l in t)hasOwnProperty.call(t,l)&&(s[l]=t[l]);s.originalType=e,s.mdxType="string"==typeof e?e:a,o[1]=s;for(var p=2;p<i;p++)o[p]=r[p];return n.createElement.apply(null,o)}return n.createElement.apply(null,r)}g.displayName="MDXCreateElement"},5297:(e,t,r)=>{r.r(t),r.d(t,{assets:()=>l,contentTitle:()=>o,default:()=>d,frontMatter:()=>i,metadata:()=>s,toc:()=>p});var n=r(7462),a=(r(7294),r(3905));const i={sidebar_label:"Program Testing",sidebar_position:12},o="How to test a Gear program",s={unversionedId:"developing-contracts/testing",id:"developing-contracts/testing",title:"How to test a Gear program",description:"Basics",source:"@site/docs/developing-contracts/testing.md",sourceDirName:"developing-contracts",slug:"/developing-contracts/testing",permalink:"/docs/developing-contracts/testing",draft:!1,editUrl:"https://github.com/gear-tech/wiki/edit/master/docs/developing-contracts/testing.md",tags:[],version:"current",sidebarPosition:12,frontMatter:{sidebar_label:"Program Testing",sidebar_position:12},sidebar:"tutorialSidebar",previous:{title:"Upload Program",permalink:"/docs/developing-contracts/deploy"},next:{title:"Testing with gtest",permalink:"/docs/developing-contracts/testing-gtest"}},l={},p=[{value:"Basics",id:"basics",level:2},{value:"Building a program in test mode",id:"building-a-program-in-test-mode",level:2},{value:"Dig deeper",id:"dig-deeper",level:2}],c={toc:p};function d(e){let{components:t,...r}=e;return(0,a.kt)("wrapper",(0,n.Z)({},c,r,{components:t,mdxType:"MDXLayout"}),(0,a.kt)("h1",{id:"how-to-test-a-gear-program"},"How to test a Gear program"),(0,a.kt)("h2",{id:"basics"},"Basics"),(0,a.kt)("p",null,"Gear uses the standard testing mechanism for Rust programs: build and run testing executables using ",(0,a.kt)("inlineCode",{parentName:"p"},"cargo"),"."),(0,a.kt)("p",null,"Following basic concepts and testing methods described in ",(0,a.kt)("a",{parentName:"p",href:"https://doc.rust-lang.org/book/ch11-00-testing.html"},"Rustbook"),", you can organize tests in two main categories: ",(0,a.kt)("strong",{parentName:"p"},"unit tests")," and ",(0,a.kt)("strong",{parentName:"p"},"integration")," tests."),(0,a.kt)("p",null,"The ",(0,a.kt)("strong",{parentName:"p"},"unit tests")," enable testing of each unit of code in isolation from the rest of the code. It helps to quickly find where the code works as expected and where it does not. One should place unit tests in the ",(0,a.kt)("inlineCode",{parentName:"p"},"src")," directory in each file with the code they test."),(0,a.kt)("p",null,"Even when code units work correctly, it is crucial to test if several library parts work together correctly. For ",(0,a.kt)("strong",{parentName:"p"},"integration tests"),", a separate ",(0,a.kt)("inlineCode",{parentName:"p"},"tests")," directory is required at the top level of your project directory, next to ",(0,a.kt)("inlineCode",{parentName:"p"},"src"),". You can make as many test files in this directory as you need. ",(0,a.kt)("inlineCode",{parentName:"p"},"cargo")," will compile each file as an individual crate."),(0,a.kt)("h1",{id:"how-to-test-a-program"},"How to test a program"),(0,a.kt)("p",null,"There are at least two ways how to test and debug Gear programs."),(0,a.kt)("p",null,"The first is the off-chain testing using a low-level ",(0,a.kt)("a",{parentName:"p",href:"https://docs.gear.rs/gtest/"},(0,a.kt)("inlineCode",{parentName:"a"},"gtest"))," crate. This approach is recommended for unit and integration tests."),(0,a.kt)("p",null,"The second is the on-chain testing with a higher level ",(0,a.kt)("a",{parentName:"p",href:"https://docs.gear.rs/gclient/"},(0,a.kt)("inlineCode",{parentName:"a"},"gclient"))," crate. It perfectly fits the needs of end-to-end testing."),(0,a.kt)("p",null,"Although ",(0,a.kt)("inlineCode",{parentName:"p"},"gclient")," is aimed at end-to-end testing, tests can be written as unit or integration tests in terms of Rust. We recommend using the integration-like approach with separate test files in the ",(0,a.kt)("inlineCode",{parentName:"p"},"tests")," directory when using the ",(0,a.kt)("inlineCode",{parentName:"p"},"gclient")," crate."),(0,a.kt)("h2",{id:"building-a-program-in-test-mode"},"Building a program in test mode"),(0,a.kt)("p",null,"First, be sure you have a compiled Wasm file of the program you want to test. You can refer to ",(0,a.kt)("a",{parentName:"p",href:"/docs/getting-started-in-5-minutes"},"Getting Started")," for additional details."),(0,a.kt)("ol",null,(0,a.kt)("li",{parentName:"ol"},(0,a.kt)("p",{parentName:"li"},"Usually, the following command is used for the regular compilation of Gear smart contracts:"),(0,a.kt)("pre",{parentName:"li"},(0,a.kt)("code",{parentName:"pre",className:"language-bash"},"cd ~/gear/contracts/first-gear-app/\ncargo build --release\n")),(0,a.kt)("p",{parentName:"li"},"The nightly compiler is required if some unstable features have been used:"),(0,a.kt)("pre",{parentName:"li"},(0,a.kt)("code",{parentName:"pre",className:"language-bash"},"cargo +nightly build --release\n"))),(0,a.kt)("li",{parentName:"ol"},(0,a.kt)("p",{parentName:"li"},"The minimal command for running tests is:"),(0,a.kt)("pre",{parentName:"li"},(0,a.kt)("code",{parentName:"pre",className:"language-bash"},"cargo test\n")),(0,a.kt)("p",{parentName:"li"},"The nightly compiler is required if your contract uses unstable Rust features, and the compiler will ask you to enable ",(0,a.kt)("inlineCode",{parentName:"p"},"nightly")," if necessary."),(0,a.kt)("pre",{parentName:"li"},(0,a.kt)("code",{parentName:"pre",className:"language-bash"},"cargo +nightly test\n")),(0,a.kt)("p",{parentName:"li"},"Build tests in release mode, so they run faster:"),(0,a.kt)("pre",{parentName:"li"},(0,a.kt)("code",{parentName:"pre",className:"language-bash"},"cargo test --release\n")))),(0,a.kt)("h2",{id:"dig-deeper"},"Dig deeper"),(0,a.kt)("p",null,"In the following two sections, we will describe how to test the Gear program using both ",(0,a.kt)("inlineCode",{parentName:"p"},"gtest")," and ",(0,a.kt)("inlineCode",{parentName:"p"},"gclient")," crates."))}d.isMDXComponent=!0}}]);