"use strict";(self.webpackChunkdocs_website=self.webpackChunkdocs_website||[]).push([[7898],{3905:(e,t,n)=>{n.d(t,{Zo:()=>u,kt:()=>m});var a=n(7294);function r(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function o(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,a)}return n}function s(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?o(Object(n),!0).forEach((function(t){r(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):o(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function i(e,t){if(null==e)return{};var n,a,r=function(e,t){if(null==e)return{};var n,a,r={},o=Object.keys(e);for(a=0;a<o.length;a++)n=o[a],t.indexOf(n)>=0||(r[n]=e[n]);return r}(e,t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(a=0;a<o.length;a++)n=o[a],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}var l=a.createContext({}),c=function(e){var t=a.useContext(l),n=t;return e&&(n="function"==typeof e?e(t):s(s({},t),e)),n},u=function(e){var t=c(e.components);return a.createElement(l.Provider,{value:t},e.children)},p={inlineCode:"code",wrapper:function(e){var t=e.children;return a.createElement(a.Fragment,{},t)}},d=a.forwardRef((function(e,t){var n=e.components,r=e.mdxType,o=e.originalType,l=e.parentName,u=i(e,["components","mdxType","originalType","parentName"]),d=c(n),m=r,g=d["".concat(l,".").concat(m)]||d[m]||p[m]||o;return n?a.createElement(g,s(s({ref:t},u),{},{components:n})):a.createElement(g,s({ref:t},u))}));function m(e,t){var n=arguments,r=t&&t.mdxType;if("string"==typeof e||r){var o=n.length,s=new Array(o);s[0]=d;var i={};for(var l in t)hasOwnProperty.call(t,l)&&(i[l]=t[l]);i.originalType=e,i.mdxType="string"==typeof e?e:r,s[1]=i;for(var c=2;c<o;c++)s[c]=n[c];return a.createElement.apply(null,s)}return a.createElement.apply(null,n)}d.displayName="MDXCreateElement"},10:(e,t,n)=>{n.r(t),n.d(t,{assets:()=>l,contentTitle:()=>s,default:()=>p,frontMatter:()=>o,metadata:()=>i,toc:()=>c});var a=n(7462),r=(n(7294),n(3905));const o={sidebar_label:"Oracle",sidebar_position:23},s="Gear Oracle",i={unversionedId:"examples/oracle",id:"examples/oracle",title:"Gear Oracle",description:"What is Oracle?",source:"@site/docs/examples/oracle.md",sourceDirName:"examples",slug:"/examples/oracle",permalink:"/docs/examples/oracle",draft:!1,editUrl:"https://github.com/gear-tech/wiki/edit/master/docs/examples/oracle.md",tags:[],version:"current",sidebarPosition:23,frontMatter:{sidebar_label:"Oracle",sidebar_position:23},sidebar:"tutorialSidebar",previous:{title:"Monopoly game",permalink:"/docs/examples/monopoly"},next:{title:"IDEA Overview",permalink:"/docs/idea/idea-overview"}},l={},c=[{value:"What is Oracle?",id:"what-is-oracle",level:2},{value:"Storage Structure",id:"storage-structure",level:2},{value:"<code>Action</code> and <code>Event</code>",id:"action-and-event",level:3},{value:"Message/Reply structures used in <code>Action</code> and <code>Event</code>",id:"messagereply-structures-used-in-action-and-event",level:3},{value:"Oracle functions",id:"oracle-functions",level:2},{value:"Conclusion",id:"conclusion",level:2}],u={toc:c};function p(e){let{components:t,...n}=e;return(0,r.kt)("wrapper",(0,a.Z)({},u,n,{components:t,mdxType:"MDXLayout"}),(0,r.kt)("h1",{id:"gear-oracle"},"Gear Oracle"),(0,r.kt)("h2",{id:"what-is-oracle"},"What is Oracle?"),(0,r.kt)("p",null,"Blockchain oracles are a combination of smart contracts and off-chain entities that connect blockchains to external systems(api, etc..), allowing other smart contracts to execute depending on real-world inputs and outputs. Oracles give the Web3 ecosystem a method to connect to existing legacy systems, data sources and advanced calculations."),(0,r.kt)("p",null,"These smart contracts can then be used to obtain external data which can't exist in blockchain space. In general oracles are used for:"),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},"Fetching aggregated tokens prices in fiat (USD, EUR, etc..)"),(0,r.kt)("li",{parentName:"ul"},"Quering Web2 API"),(0,r.kt)("li",{parentName:"ul"},"Obtaining prices for different securities")),(0,r.kt)("p",null,"Moreover, oracles allow the creation of lending / DEX protocols, which form an important part of DeFi."),(0,r.kt)("p",null,"Gear provides an example of the native implementation of randomness oracle, which provides an ability to use random numbers in smart contracts. It can be used as is or modified to suit your own scenarios. Anyone can easily create their own oracle and run it on the Gear Network. The source code is available on ",(0,r.kt)("a",{parentName:"p",href:"https://github.com/gear-dapps/oracle"},"GitHub"),"."),(0,r.kt)("h2",{id:"storage-structure"},"Storage Structure"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-rust"},"#[derive(Debug, Default)]\npub struct RandomnessOracle {\n    pub owner: ActorId,\n    pub values: BTreeMap<u128, state::Random>,\n    pub last_round: u128,\n    pub manager: ActorId,\n}\n")),(0,r.kt)("h3",{id:"action-and-event"},(0,r.kt)("inlineCode",{parentName:"h3"},"Action")," and ",(0,r.kt)("inlineCode",{parentName:"h3"},"Event")),(0,r.kt)("p",null,(0,r.kt)("inlineCode",{parentName:"p"},"Event")," is generated when ",(0,r.kt)("inlineCode",{parentName:"p"},"Action")," is triggered. ",(0,r.kt)("inlineCode",{parentName:"p"},"Action")," enum wraps various ",(0,r.kt)("inlineCode",{parentName:"p"},"Input")," structs, ",(0,r.kt)("inlineCode",{parentName:"p"},"Event")," wraps ",(0,r.kt)("inlineCode",{parentName:"p"},"Reply"),"."),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-rust"},"#[derive(Debug, Encode, Decode, TypeInfo)]\npub enum Action {\n    SetRandomValue { round: u128, value: state::Random },\n    GetLastRoundWithRandomValue,\n    UpdateManager(ActorId),\n}\n")),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-rust"},"#[derive(Debug, Encode, Decode, TypeInfo)]\npub enum Event {\n    NewManager(ActorId),\n    NewRandomValue {\n        round: u128,\n        value: state::Random,\n    },\n    LastRoundWithRandomValue {\n        round: u128,\n        random_value: state::RandomSeed,\n    },\n}\n")),(0,r.kt)("h3",{id:"messagereply-structures-used-in-action-and-event"},"Message/Reply structures used in ",(0,r.kt)("inlineCode",{parentName:"h3"},"Action")," and ",(0,r.kt)("inlineCode",{parentName:"h3"},"Event")),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-rust"},"/// Used to represent high and low parts of unsigned 256-bit integer.\npub type RandomSeed = (u128, u128);\n")),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-rust"},"#[derive(Debug, Clone, Encode, Decode, TypeInfo)]\npub struct Random {\n    pub randomness: RandomSeed,\n    pub signature: String,\n    pub prev_signature: String,\n}\n")),(0,r.kt)("h2",{id:"oracle-functions"},"Oracle functions"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-rust"},"    /// `Manager` method for specifying `value` for provided `round`.\n    pub fn set_random_value(&mut self, round: u128, value: &state::Random)\n\n    /// Updates current `manager` to `new_manager`.\n    pub fn update_manager(&mut self, new_manager: &ActorId)\n")),(0,r.kt)("h2",{id:"conclusion"},"Conclusion"),(0,r.kt)("p",null,"A source code of the contract example provided by Gear is available on GitHub: ",(0,r.kt)("a",{parentName:"p",href:"https://github.com/gear-dapps/oracle/blob/wip/randomness-oracle/src/lib.rs"},"oracle/randomness-oracle/src/lib.rs"),"."),(0,r.kt)("p",null,"See also an example of the smart contract testing implementation based on ",(0,r.kt)("inlineCode",{parentName:"p"},"gtest"),": ",(0,r.kt)("a",{parentName:"p",href:"https://github.com/gear-dapps/oracle/blob/wip/randomness-oracle/tests/randomness_oracle.rs"},"oracle/randomness-oracle/tests/randomness_oracle.rs"),"."),(0,r.kt)("p",null,"For more details about testing smart contracts written on Gear, refer to this article: ",(0,r.kt)("a",{parentName:"p",href:"/docs/developing-contracts/testing"},"Program Testing"),"."))}p.isMDXComponent=!0}}]);