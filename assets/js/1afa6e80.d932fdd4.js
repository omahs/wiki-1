"use strict";(self.webpackChunkdocs_website=self.webpackChunkdocs_website||[]).push([[7356],{3905:(e,t,a)=>{a.d(t,{Zo:()=>d,kt:()=>m});var r=a(7294);function n(e,t,a){return t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}function s(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,r)}return a}function o(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?s(Object(a),!0).forEach((function(t){n(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):s(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}function i(e,t){if(null==e)return{};var a,r,n=function(e,t){if(null==e)return{};var a,r,n={},s=Object.keys(e);for(r=0;r<s.length;r++)a=s[r],t.indexOf(a)>=0||(n[a]=e[a]);return n}(e,t);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);for(r=0;r<s.length;r++)a=s[r],t.indexOf(a)>=0||Object.prototype.propertyIsEnumerable.call(e,a)&&(n[a]=e[a])}return n}var l=r.createContext({}),c=function(e){var t=r.useContext(l),a=t;return e&&(a="function"==typeof e?e(t):o(o({},t),e)),a},d=function(e){var t=c(e.components);return r.createElement(l.Provider,{value:t},e.children)},p={inlineCode:"code",wrapper:function(e){var t=e.children;return r.createElement(r.Fragment,{},t)}},u=r.forwardRef((function(e,t){var a=e.components,n=e.mdxType,s=e.originalType,l=e.parentName,d=i(e,["components","mdxType","originalType","parentName"]),u=c(a),m=n,h=u["".concat(l,".").concat(m)]||u[m]||p[m]||s;return a?r.createElement(h,o(o({ref:t},d),{},{components:a})):r.createElement(h,o({ref:t},d))}));function m(e,t){var a=arguments,n=t&&t.mdxType;if("string"==typeof e||n){var s=a.length,o=new Array(s);o[0]=u;var i={};for(var l in t)hasOwnProperty.call(t,l)&&(i[l]=t[l]);i.originalType=e,i.mdxType="string"==typeof e?e:n,o[1]=i;for(var c=2;c<s;c++)o[c]=a[c];return r.createElement.apply(null,o)}return r.createElement.apply(null,a)}u.displayName="MDXCreateElement"},6891:(e,t,a)=>{a.r(t),a.d(t,{assets:()=>l,contentTitle:()=>o,default:()=>p,frontMatter:()=>s,metadata:()=>i,toc:()=>c});var r=a(7462),n=(a(7294),a(3905));const s={sidebar_position:6,sidebar_label:"State Transition"},o="State transition",i={unversionedId:"gear/technology/state-transition",id:"gear/technology/state-transition",title:"State transition",description:"Each system follows the rules according to which the state of the system evolves. As the network processes new input data, the state is advanced according to state transition rules. This input data is packed in granular pieces of information called transactions.",source:"@site/docs/gear/technology/state-transition.md",sourceDirName:"gear/technology",slug:"/gear/technology/state-transition",permalink:"/docs/gear/technology/state-transition",draft:!1,editUrl:"https://github.com/gear-tech/wiki/edit/master/docs/gear/technology/state-transition.md",tags:[],version:"current",sidebarPosition:6,frontMatter:{sidebar_position:6,sidebar_label:"State Transition"},sidebar:"tutorialSidebar",previous:{title:"Gear Network State",permalink:"/docs/gear/technology/state"},next:{title:"Glossary",permalink:"/docs/gear/glossary"}},l={},c=[{value:"Upload a program",id:"upload-a-program",level:3},{value:"Upload a code",id:"upload-a-code",level:3},{value:"Create a program",id:"create-a-program",level:3},{value:"Send a message",id:"send-a-message",level:3},{value:"Send a reply",id:"send-a-reply",level:3},{value:"Claim a value from mailbox",id:"claim-a-value-from-mailbox",level:3},{value:"Dequeue messages",id:"dequeue-messages",level:3},{value:"Balance transfers",id:"balance-transfers",level:3},{value:"Messages, blocks and events lifecycle",id:"messages-blocks-and-events-lifecycle",level:3}],d={toc:c};function p(e){let{components:t,...s}=e;return(0,n.kt)("wrapper",(0,r.Z)({},d,s,{components:t,mdxType:"MDXLayout"}),(0,n.kt)("h1",{id:"state-transition"},"State transition"),(0,n.kt)("p",null,"Each system follows the rules according to which the state of the system evolves. As the network processes new input data, the state is advanced according to state transition rules. This input data is packed in granular pieces of information called transactions."),(0,n.kt)("p",null,"Gear nodes maintain and synchronize a transaction pool which contains all those new transactions. When any node (validator or not) receives a transaction, the node propagates the transaction to all connected nodes. For advanced reading how the transaction pool operates, refer to ",(0,n.kt)("a",{parentName:"p",href:"https://substrate.dev/docs/en/knowledgebase/learn-substrate/tx-pool"},"Substrate Documentation"),"."),(0,n.kt)("p",null,"When a Gear validator node comes to produce a new block, some (or all) transactions from the pool are merged into a block and the network undergoes a state transition via this block. Transactions that were not taken in the last block remain in the pool until the next block is produced."),(0,n.kt)("p",null,"A Gear Network supports the following types of transactions:"),(0,n.kt)("ol",null,(0,n.kt)("li",{parentName:"ol"},(0,n.kt)("strong",{parentName:"li"},"Upload a program")," - user uploads new program(s) - smart-contracts"),(0,n.kt)("li",{parentName:"ol"},(0,n.kt)("strong",{parentName:"li"},"Upload a code")," - user uploads a code to create programs from it later"),(0,n.kt)("li",{parentName:"ol"},(0,n.kt)("strong",{parentName:"li"},"Create a program")," - program or user creates a program from the previously uploaded code"),(0,n.kt)("li",{parentName:"ol"},(0,n.kt)("strong",{parentName:"li"},"Send a message")," - program or user fills the message queue"),(0,n.kt)("li",{parentName:"ol"},(0,n.kt)("strong",{parentName:"li"},"Send a reply")," - similar to the message but can be sent only as a reply to the received message"),(0,n.kt)("li",{parentName:"ol"},(0,n.kt)("strong",{parentName:"li"},"Claim a value from mailbox")," - user requests to transfer value associated with the message in his mailbox"),(0,n.kt)("li",{parentName:"ol"},(0,n.kt)("strong",{parentName:"li"},"Dequeue messages")," - validators (block producers) dequeue multiple messages, running associated programs"),(0,n.kt)("li",{parentName:"ol"},(0,n.kt)("strong",{parentName:"li"},"Balance transfers")," - Gear engine performs user-program-validator balance transfers")),(0,n.kt)("p",null,"Message processing is performed in the reserved space of the block construction/import time. It is guaranteed that message processing will be executed in every block, and at least at some particular rate determined by current instance settings."),(0,n.kt)("h3",{id:"upload-a-program"},"Upload a program"),(0,n.kt)("p",null,"Designated authorities (or any user for public implementation) of Gear network can propose a new program saved to the state. For public networks, a balance associated with a program is also provided. This new balance then constitutes the initial balance (Existential Deposit)."),(0,n.kt)("h3",{id:"upload-a-code"},"Upload a code"),(0,n.kt)("p",null,"One can upload a Wasm code without initialization. This code cannot be executed as a program but it is saved to the storage and can be used for creating new programs from it. Both users and programs can create programs from uploaded code."),(0,n.kt)("h3",{id:"create-a-program"},"Create a program"),(0,n.kt)("p",null,"Both users and programs can create new programs from the uploaded code. The code can be reused many times to produce several programs."),(0,n.kt)("h3",{id:"send-a-message"},"Send a message"),(0,n.kt)("p",null,"End-users interact with programs via sending messages to a Gear Network. Messages sent to a Gear Network fill up the global message queue. This queue can be viewed as a runtime-driven transaction queue but with the guarantee that any message accepted into it will eventually be processed. Putting a message in the queue is not free and therefore a message is guaranteed to be dispatched."),(0,n.kt)("p",null,"Programs also exchange messages with each other. The result of the received message can be another message (reply) addressed to another program or a user or a designated behavior to be used for the next message it receives. A program can also send a message the execution result of which will be a creation of another program."),(0,n.kt)("h3",{id:"send-a-reply"},"Send a reply"),(0,n.kt)("p",null,"The reply is similar to the message described above with the only difference that the reply can be sent only as a response to the received message. Users can send the reply to the message contained in their mailboxes."),(0,n.kt)("h3",{id:"claim-a-value-from-mailbox"},"Claim a value from mailbox"),(0,n.kt)("p",null,"After receiving a message with an associated value, the user has to claim this value to transfer it from the message to the user. Unclaimed value is to be returned to the sender after the message leaves the mailbox after its gas limit exhausts."),(0,n.kt)("h3",{id:"dequeue-messages"},"Dequeue messages"),(0,n.kt)("p",null,"Validators can choose which messages to dequeue when it's their turn to produce the next block. It eliminates the need of each particular validator to maintain the full memory state. Dequeuing occurs only at the end of each block. During dequeuing, new messages can be generated. They can also be processed in this phase, but also can stay in the queue for the next block (and another validator)."),(0,n.kt)("h3",{id:"balance-transfers"},"Balance transfers"),(0,n.kt)("p",null,"Regular balance transfers can be performed in two ways. The first way is to use correspondent extrinsics (e.g. ",(0,n.kt)("inlineCode",{parentName:"p"},"transfer"),", ",(0,n.kt)("inlineCode",{parentName:"p"},"setBalance"),", etc.) from the Substrate ",(0,n.kt)("inlineCode",{parentName:"p"},"Balances")," pallet. The second way is to send a message from one user to another with associated value."),(0,n.kt)("h3",{id:"messages-blocks-and-events-lifecycle"},"Messages, blocks and events lifecycle"),(0,n.kt)("p",null,'The picture below illustrates the eternal lifecycle of Gear machinery. As the actor model for communications dictates, nothing is shared, there are only messages. Messages with destination "system" end up in the event log to be inspected in the user space.'),(0,n.kt)("p",null,(0,n.kt)("img",{alt:"alt text",src:a(9938).Z,width:"1400",height:"1400"})))}p.isMDXComponent=!0},9938:(e,t,a)=>{a.d(t,{Z:()=>r});const r=a.p+"assets/images/mq-df2e074d5eb9243488edd7b3b907cefa.jpg"}}]);