"use strict";(self.webpackChunkdocs_website=self.webpackChunkdocs_website||[]).push([[9501],{3905:(e,t,a)=>{a.d(t,{Zo:()=>c,kt:()=>u});var r=a(7294);function s(e,t,a){return t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}function n(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,r)}return a}function i(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?n(Object(a),!0).forEach((function(t){s(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):n(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}function o(e,t){if(null==e)return{};var a,r,s=function(e,t){if(null==e)return{};var a,r,s={},n=Object.keys(e);for(r=0;r<n.length;r++)a=n[r],t.indexOf(a)>=0||(s[a]=e[a]);return s}(e,t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);for(r=0;r<n.length;r++)a=n[r],t.indexOf(a)>=0||Object.prototype.propertyIsEnumerable.call(e,a)&&(s[a]=e[a])}return s}var l=r.createContext({}),m=function(e){var t=r.useContext(l),a=t;return e&&(a="function"==typeof e?e(t):i(i({},t),e)),a},c=function(e){var t=m(e.components);return r.createElement(l.Provider,{value:t},e.children)},p={inlineCode:"code",wrapper:function(e){var t=e.children;return r.createElement(r.Fragment,{},t)}},d=r.forwardRef((function(e,t){var a=e.components,s=e.mdxType,n=e.originalType,l=e.parentName,c=o(e,["components","mdxType","originalType","parentName"]),d=m(a),u=s,h=d["".concat(l,".").concat(u)]||d[u]||p[u]||n;return a?r.createElement(h,i(i({ref:t},c),{},{components:a})):r.createElement(h,i({ref:t},c))}));function u(e,t){var a=arguments,s=t&&t.mdxType;if("string"==typeof e||s){var n=a.length,i=new Array(n);i[0]=d;var o={};for(var l in t)hasOwnProperty.call(t,l)&&(o[l]=t[l]);o.originalType=e,o.mdxType="string"==typeof e?e:s,i[1]=o;for(var m=2;m<n;m++)i[m]=a[m];return r.createElement.apply(null,i)}return r.createElement.apply(null,a)}d.displayName="MDXCreateElement"},5551:(e,t,a)=>{a.r(t),a.d(t,{assets:()=>l,contentTitle:()=>i,default:()=>p,frontMatter:()=>n,metadata:()=>o,toc:()=>m});var r=a(7462),s=(a(7294),a(3905));const n={sidebar_position:3},i="Mailbox",o={unversionedId:"developing-contracts/mailbox",id:"developing-contracts/mailbox",title:"Mailbox",description:"When the program sends a message to the user, this message is placed in the user's mailbox. Actually, the mailbox is a dedicated storage that keeps a message received from a program.",source:"@site/docs/developing-contracts/mailbox.md",sourceDirName:"developing-contracts",slug:"/developing-contracts/mailbox",permalink:"/zh-cn/docs/developing-contracts/mailbox",draft:!1,editUrl:"https://github.com/gear-tech/wiki/edit/master/docs/developing-contracts/mailbox.md",tags:[],version:"current",sidebarPosition:3,frontMatter:{sidebar_position:3},sidebar:"tutorialSidebar",previous:{title:"Gear \u5e93",permalink:"/zh-cn/docs/developing-contracts/gstd"},next:{title:"\u5f02\u6b65\u5408\u7ea6\u901a\u8baf",permalink:"/zh-cn/docs/developing-contracts/interactions-between-programs"}},l={},m=[{value:"User sends a reply to the message",id:"user-sends-a-reply-to-the-message",level:2},{value:"User claims value from a message in the mailbox",id:"user-claims-value-from-a-message-in-the-mailbox",level:2},{value:"User ignores a message in the mailbox",id:"user-ignores-a-message-in-the-mailbox",level:2}],c={toc:m};function p(e){let{components:t,...a}=e;return(0,s.kt)("wrapper",(0,r.Z)({},c,a,{components:t,mdxType:"MDXLayout"}),(0,s.kt)("h1",{id:"mailbox"},"Mailbox"),(0,s.kt)("p",null,"When the program sends a message to the user, this message is placed in the user's mailbox. Actually, the mailbox is a dedicated storage that keeps a message received from a program."),(0,s.kt)("p",null,"The user can detect a message received by subscribing to the ",(0,s.kt)("a",{parentName:"p",href:"https://docs.gear.rs/pallet_gear/pallet/enum.Event.html#variant.UserMessageSent"},(0,s.kt)("inlineCode",{parentName:"a"},"UserMessageSent"))," event."),(0,s.kt)("p",null,"When using the IDEA website one should go to the ",(0,s.kt)("a",{parentName:"p",href:"https://idea.gear-tech.io/mailbox"},"https://idea.gear-tech.io/mailbox")," section."),(0,s.kt)("admonition",{type:"note"},(0,s.kt)("p",{parentName:"admonition"},"A message is charged for being in the mailbox. Therefore, a message can be in the mailbox for a limited time.")),(0,s.kt)("p",null,"Let's explore possible user reactions to the mailbox's message."),(0,s.kt)("h2",{id:"user-sends-a-reply-to-the-message"},"User sends a reply to the message"),(0,s.kt)("p",null,"The program can send a message to the user and wait for a reply from him. The user can reply using a ",(0,s.kt)("a",{parentName:"p",href:"https://docs.gear.rs/pallet_gear/pallet/struct.Pallet.html#method.send_reply"},(0,s.kt)("inlineCode",{parentName:"a"},"send_reply"))," extrinsic. The value associated with the message is transferred to the user's account, the message is removed from the mailbox, and the new reply message is added to the message queue."),(0,s.kt)("h2",{id:"user-claims-value-from-a-message-in-the-mailbox"},"User claims value from a message in the mailbox"),(0,s.kt)("p",null,"If a message in the mailbox has an associated value, the user can claim it using a ",(0,s.kt)("a",{parentName:"p",href:"https://docs.gear.rs/pallet_gear/pallet/struct.Pallet.html#method.claim_value"},(0,s.kt)("inlineCode",{parentName:"a"},"claim_value"))," extrinsic. Value is transferred to the user's account and the message is removed from the mailbox."),(0,s.kt)("h2",{id:"user-ignores-a-message-in-the-mailbox"},"User ignores a message in the mailbox"),(0,s.kt)("p",null,"A message is charged for every block in the mailbox within its gas limit. If the message hasn't an explicit gas limit, gas is borrowed from the origin's limit (e.g. an actor that has initiated the execution)."),(0,s.kt)("p",null,"When the message's gas runs out, the message is removed from the mailbox, and the associated value transferred back to the message sender."))}p.isMDXComponent=!0}}]);